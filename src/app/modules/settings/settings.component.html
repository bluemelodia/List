<section class="form-container">
    <app-heading [level]="headerLevel.H1" text="User Settings"></app-heading>
    <form [formGroup]="settingsForm"
        (ngSubmit)="onSubmit()">
        <fieldset class="notification-channels">
            <app-heading [level]="headerLevel.H3" text="Channels">
                <span class="event-form__optional" post>Optional</span>
            </app-heading>
            <span class="form-instructions">Select the channels where you would like to receive upcoming reminders.</span>
            <app-checkbox
                name="Email"
                [checkboxName]="channel.email"
                [form]="settingsForm.controls.channels"
				(valueChanged)="setChannelValidationStatus(channel.email, $event)">
            </app-checkbox>
            <fieldset class="email" *ngIf="isChannelChecked(channel.email)">
                <input type="email" 
                    formControlName="email"
                    placeholder="Email"/>
                <div class="input-error" *ngIf="validateEmail$ | async as validateEmail">
                        <span *ngIf="validateEmail && settingsFormControl.email.errors?.missingEmail">
                            Please enter an email address.
                        </span>    
                        <span *ngIf="validateEmail && settingsFormControl.email.errors?.invalidEmail">
                            Please enter a valid email address.
                        </span>
                </div>
            </fieldset>
            <app-checkbox
                name="Text Message"
                [checkboxName]="channel.text"
                [form]="settingsForm.controls.channels"
				(valueChanged)="setChannelValidationStatus(channel.text, $event)">
            </app-checkbox>
            <fieldset class="phone" *ngIf="isChannelChecked(channel.text)">
				<app-phone [form]="settingsForm" [startingCountry]="startingCountry"></app-phone>
                <div class="input-error" *ngIf="validatePhone$| async as validatePhone">
                        <span *ngIf="validatePhone && settingsFormControl.phone.errors?.missingPhone">
                            Please enter a phone number.
                        </span>    
                        <span *ngIf="validatePhone && settingsFormControl.phone.errors?.invalidPhone">
                            Please enter a valid phone number.
                        </span>
                </div>
            </fieldset>
        </fieldset>
		<fieldset class="notification-options">
            <app-heading [level]="headerLevel.H3" text="Reminders">
                <span class="event-form__optional" post>Optional</span>
            </app-heading>
            <span class="form-instructions">Select the events and tasks you would like to receive reminders for.</span>
			<app-checkbox
                [name]="topic.Birthdays"
                [checkboxName]="topic.Birthdays"
                [form]="settingsForm.controls.tasks">
            </app-checkbox>
        </fieldset>
        <fieldset class="form-actions">  
            <button type="submit">
                Update
            </button>
        </fieldset>
    </form>
</section>
